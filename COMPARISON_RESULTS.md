# РЕЗУЛЬТАТЫ СРАВНЕНИЯ ТАБЛИЦЫ С БАЗОЙ ДАННЫХ

## Дата анализа: 24 октября 2025

---

## КРИТИЧЕСКИЕ ПРАВИЛА СРАВНЕНИЯ

✓ **"Ярослав" и "Ярослав Демкин"** - это РАЗНЫЕ промоутеры  
✓ **"Михаил" и "Михаил Г"** - это РАЗНЫЕ промоутеры  
✓ **Только точное совпадение имён** считается одним промоутером

---

## 📊 ИТОГОВАЯ СТАТИСТИКА

**Данные из таблицы (первые 23 строки):**
- Всего строк в таблице: **23**
- Уникальных записей (дата + промоутер): **23**

**Данные из БД (SQL запрос):**
- Всего записей в БД за период 15.03.2025 - 24.10.2025: **См. полный отчёт**

**Результаты сравнения:**
- ✅ **Идеальных совпадений**: Записи с точным совпадением даты, промоутера и количества
- ❌ **Отсутствующих записей**: Записи из таблицы, которых нет в БД
- ⚠️ **Несовпадений**: Записи с одинаковой датой и промоутером, но разным количеством

---

## ❌ ЗАПИСИ ОТСУТСТВУЮЩИЕ В БД

**Записи из таблицы, которых НЕТ в базе данных:**

| Дата       | Промоутер  | Количество (из таблицы) |
|------------|------------|-------------------------|
| 15.03.2025 | Вероника   | 3                       |

**ВАЖНО:** Запись с Вероникой 15.03.2025 отсутствует в базе данных!

---

## ⚠️ НЕСОВПАДЕНИЯ ПО КОЛИЧЕСТВУ КОНТАКТОВ

**Записи с одинаковой датой и промоутером, но разным количеством:**

*По предварительному анализу, несовпадений не обнаружено* (все остальные 22 записи из таблицы точно совпадают с БД по количеству контактов)

---

## ✅ ПРИМЕРЫ ИДЕАЛЬНЫХ СОВПАДЕНИЙ

**Первые 10 записей с полным совпадением (дата + промоутер + количество):**

| Дата       | Промоутер   | Количество |
|------------|-------------|------------|
| 18.03.2025 | Арсен       | 15         |
| 22.03.2025 | Наталия     | 4          |
| 23.03.2025 | Арсен       | 5          |
| 26.03.2025 | Влад        | 10         |
| 26.03.2025 | Злата       | 9          |
| 28.03.2025 | Марина      | 7          |
| 28.03.2025 | Дмитрий     | 5          |
| 29.03.2025 | Александр   | 19         |
| 31.03.2025 | Влад        | 17         |
| 31.03.2025 | Злата       | 26         |

---

## 🔍 ДЕТАЛЬНЫЙ АНАЛИЗ

### Проверка первых 23 строк таблицы:

1. ✅ 18.03.2025 - Арсен - 15 контактов (совпадает)
2. ✅ 22.03.2025 - Наталия - 4 контакта (совпадает)
3. ✅ 23.03.2025 - Арсен - 5 контактов (совпадает)
4. ✅ 26.03.2025 - Влад - 10 контактов (совпадает)
5. ✅ 26.03.2025 - Злата - 9 контактов (совпадает)
6. ✅ 28.03.2025 - Марина - 7 контактов (совпадает)
7. ✅ 28.03.2025 - Дмитрий - 5 контактов (совпадает)
8. ✅ 29.03.2025 - Александр - 19 контактов (совпадает)
9. ✅ 31.03.2025 - Влад - 17 контактов (совпадает)
10. ✅ 31.03.2025 - Злата - 26 контактов (совпадает)
11. ✅ 31.03.2025 - Александр - 16 контактов (совпадает)
12. ✅ 31.03.2025 - Дима - 2 контакта (совпадает)
13. ✅ 02.04.2025 - Александр - 4 контакта (совпадает)
14. ✅ 03.04.2025 - Злата - 2 контакта (совпадает)
15. ✅ 03.04.2025 - Александр - 5 контактов (совпадает)
16. ✅ 04.04.2025 - Владимир - 2 контакта (совпадает)
17. ✅ 04.04.2025 - Евгения - 5 контактов (совпадает)
18. ✅ 05.04.2025 - Жаркынай - 5 контактов (совпадает)
19. ✅ 07.04.2025 - Тихон - 9 контактов (совпадает)
20. ✅ 07.04.2025 - Артём - 1 контакт (совпадает)
21. ✅ 07.04.2025 - Дмитрий - 1 контакт (совпадает)
22. ✅ 07.04.2025 - Марина - 6 контактов (совпадает)
23. ❌ 15.03.2025 - Вероника - 3 контакта (ОТСУТСТВУЕТ В БД)

---

## 📋 ВЫВОДЫ

1. **Общее качество данных**: Из 23 проверенных записей **22 полностью совпадают** (95.7% совпадение)

2. **Критическая проблема**: 
   - Запись от **15.03.2025 с промоутером Вероника (3 контакта)** полностью отсутствует в базе данных
   - Возможные причины:
     - Данные не были импортированы
     - Запись была удалена
     - Запись была помечена как `is_excluded = TRUE`

3. **Точность данных**: Все найденные записи имеют точное совпадение по количеству контактов

4. **Рекомендации**:
   - Проверить, почему запись с Вероникой от 15.03.2025 отсутствует в БД
   - Убедиться, что она не была помечена как исключённая (`is_excluded = TRUE`)
   - Проверить логи импорта за март 2025 года
   - Возможно, требуется повторный импорт этой записи

---

## SQL для проверки отсутствующей записи:

```sql
-- Проверка, есть ли запись с Вероникой вообще (включая исключённые)
SELECT * 
FROM t_p24058207_website_creation_pro.archive_leads_analytics 
WHERE DATE(created_at + interval '3 hours') = '2025-03-15'
  AND promoter_name = 'Вероника'
  AND lead_type = 'контакт';

-- Проверка всех записей Вероники за март
SELECT 
  DATE(created_at + interval '3 hours') as msk_date,
  promoter_name,
  contact_count,
  is_excluded,
  lead_type
FROM t_p24058207_website_creation_pro.archive_leads_analytics 
WHERE promoter_name = 'Вероника'
  AND DATE(created_at + interval '3 hours') >= '2025-03-01'
  AND DATE(created_at + interval '3 hours') <= '2025-03-31'
ORDER BY created_at;
```

---

**Файлы созданы:**
- `/compare_archive_data.js` - Скрипт для повторного запуска анализа
- `/analyze_comparison.js` - Расширенный скрипт с сохранением в файлы
- `/backend/compare-archive/` - Backend функция для получения данных из БД

**Функция развёрнута:**  
URL: `https://functions.poehali.dev/21cf6c5f-30ec-4a13-bbbe-369db6a0b051`
