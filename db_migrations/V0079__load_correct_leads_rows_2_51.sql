-- Загрузка строк 2-51 из списка
WITH source_data AS (
  SELECT * FROM (VALUES
    ('18.03.2025', 'ШИЯ Солнцево', 'Арсен', 15),
    ('22.03.2025', 'Воркаут Царицыно', 'Наталия', 4),
    ('23.03.2025', 'ШИЯ Солнцево', 'Арсен', 5),
    ('26.03.2025', 'ШИЯ Солнцево', 'Влад', 10),
    ('26.03.2025', 'ШИЯ Солнцево', 'Злата', 9),
    ('28.03.2025', 'Топ Беляево', 'Марина', 7),
    ('28.03.2025', 'Воркаут Царицыно', 'Дмитрий', 5),
    ('29.03.2025', 'Худ.гимн. Люблино', 'Александр', 19),
    ('31.03.2025', 'ШИЯ Солнцево', 'Влад', 17),
    ('31.03.2025', 'ШИЯ Солнцево', 'Злата', 26),
    ('31.03.2025', 'Худ.Гимн. Люблино', 'Александр', 16),
    ('31.03.2025', 'ШИЯ Солнцево', 'Дима', 2),
    ('02.04.2025', 'Худ.Гимн. Люблино', 'Александр', 4),
    ('03.04.2025', 'Топ Академическая', 'Злата', 2),
    ('03.04.2025', 'Худ.Гимн Люблино', 'Александр', 5),
    ('04.04.2025', 'ШИЯ Кузьминки', 'Владимир', 2),
    ('04.04.2025', 'ШИЯ Кузьминки', 'Евгения', 5),
    ('05.04.2025', 'ШИЯ Солнцево', 'Жаркынай', 5),
    ('07.04.2025', 'Левита Жулебино', 'Тихон', 9),
    ('07.04.2025', 'Левита Жулебино', 'Артём', 1),
    ('07.04.2025', 'Левита Жулебино', 'Дмитрий', 1),
    ('07.04.2025', 'Топ Беляево', 'Марина', 6),
    ('08.04.2025', 'Топ Беляево', 'Марина', 5),
    ('08.04.2025', 'ШИЯ Солнцево', 'Марк', 2),
    ('08.04.2025', 'ШИЯ Солнцево', 'Элина', 5),
    ('08.04.2025', 'ШИЯ Солнцево', 'Людмила', 11),
    ('08.04.2025', 'ШИЯ Солнцево', 'Татьяна', 4),
    ('09.04.2025', 'ШИЯ Стахановская', 'Марк', 2),
    ('09.04.2025', 'ШИЯ Стахановская', 'Николай Савр', 14),
    ('09.04.2025', 'ШИЯ Стахановская', 'Софья', 6),
    ('09.04.2025', 'ШИЯ Стахановская', 'Руслан', 22),
    ('09.04.2025', 'ШИЯ Стахановская', 'Александр', 11),
    ('09.04.2025', 'ШИЯ Стахановская', 'Алексей', 12),
    ('10.04.2025', 'ТОП Академическая', 'Константин', 4),
    ('10.04.2025', 'ТОП Академическая', 'Иван', 2),
    ('10.04.2025', 'ТОП Академическая', 'Дмитрий', 1),
    ('13.04.2025', 'ТОП Академическая', 'Амина', 16),
    ('14.04.2025', 'ТОП Беляево', 'Амина', 12),
    ('16.04.2025', 'ТОП Беляево', 'Амина', 12),
    ('17.04.2025', 'ТОП Академическая', 'Амина', 10),
    ('20.04.2025', 'ТОП Академическая', 'Софья', 15),
    ('23.04.2025', 'ШИЯ Солнцево', 'Амина', 12),
    ('26.05.2025', 'ТОП Академическая', 'Александра', 15),
    ('26.05.2025', 'ТОП Академическая', 'Анастасия', 11),
    ('26.05.2025', 'ТОП Академическая', 'Александр', 5),
    ('28.05.2025', 'ТОП Академическая', 'Денис', 5),
    ('28.05.2025', 'ТОП Академическая', 'Данила', 10),
    ('28.05.2025', 'ТОП Академическая', 'Анастасия', 21),
    ('28.05.2025', 'ТОП Беляево', 'Василий', 1),
    ('28.05.2025', 'ТОП Беляево', 'Данила', 10)
  ) AS t(date_str, org_name, user_name, contacts)
)
INSERT INTO t_p24058207_website_creation_pro.leads_analytics 
  (user_id, organization_id, lead_type, lead_result, is_active, created_at)
SELECT 
  u.id,
  o.id,
  'контакт',
  '',
  true,
  TO_TIMESTAMP(sd.date_str, 'DD.MM.YYYY') - INTERVAL '3 hours'
FROM source_data sd
JOIN t_p24058207_website_creation_pro.users u ON u.name = sd.user_name
JOIN t_p24058207_website_creation_pro.organizations o ON o.name = sd.org_name
CROSS JOIN generate_series(1, sd.contacts);