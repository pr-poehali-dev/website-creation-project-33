-- Загрузка строк 52-101
WITH source_data AS (
  SELECT * FROM (VALUES
    ('28.05.2025', 'ТОП Беляево', 'Данила', 10),
    ('28.05.2025', 'ТОП Беляево', 'Анастасия', 10),
    ('28.05.2025', 'ТОП Беляево', 'Денис', 1),
    ('29.05.2025', 'ТОП Севастопольская', 'Александра', 3),
    ('29.05.2025', 'ТОП Севастопольская', 'Михаил', 10),
    ('29.05.2025', 'ТОП Севастопольская', 'Василий', 4),
    ('29.05.2025', 'ТОП Севастопольская', 'Сергей', 4),
    ('29.05.2025', 'ТОП Севастопольская', 'Артём', 1),
    ('30.05.2025', 'ТОП Домодедовская', 'Артём', 3),
    ('30.05.2025', 'ТОП Беляево', 'Анастасия', 10),
    ('30.05.2025', 'ТОП Беляево', 'Александра', 10),
    ('30.05.2025', 'ТОП Беляево', 'Михаил', 11),
    ('30.05.2025', 'ТОП Наро-Фоминск', 'Михаил', 10),
    ('30.05.2025', 'Воркаут Царицыно', 'Артём', 5),
    ('30.05.2025', 'Воркаут Царицыно', 'Никита', 6),
    ('01.06.2025', 'Воркаут Царицыно', 'Артём', 5),
    ('01.06.2025', 'ТОП Севастопольская', 'Анастасия', 9),
    ('01.06.2025', 'Воркаут Царицыно', 'Артём', 5),
    ('02.06.2025', 'Воркаут Царицыно', 'Сергей', 13),
    ('02.06.2025', 'Воркаут Царицыно', 'Ярослав Демкин', 13),
    ('02.06.2025', 'Воркаут Царицыно', 'Иван', 8),
    ('02.06.2025', 'Воркаут Царицыно', 'Амир', 8),
    ('02.06.2025', 'ТОП Севастопольская', 'Никита', 15),
    ('02.06.2025', 'ТОП Севастопольская', 'Анастасия', 1),
    ('04.06.2025', 'ТОП Беляево', 'Дамир', 17),
    ('04.06.2025', 'ТОП Беляево', 'Анастасия', 13),
    ('04.06.2025', 'ТОП Беляево', 'Артём', 6),
    ('04.06.2025', 'ТОП Бибирево', 'Александра, Владислав, Максим, Андрей, Ноэль', 29),
    ('04.06.2025', 'ТОП Домодедовская', 'Дамир', 22),
    ('04.06.2025', 'ТОП Академическая', 'Ярослав Демкин', 15),
    ('04.06.2025', 'ТОП Академическая', 'Артём', 1),
    ('04.06.2025', 'ТОП Академическая', 'Амир', 15),
    ('04.06.2025', 'ТОП Академическая', 'Иван', 4),
    ('04.06.2025', 'ТОП Академическая', 'Михаил', 7),
    ('05.06.2025', 'ТОП Домодедовская', 'Дамир', 26),
    ('06.06.2025', 'ТОП Мытищи', 'Виктория', 2),
    ('06.06.2025', 'ТОП Мытищи', 'Анна', 2),
    ('06.06.2025', 'ТОП Севастопольская', 'Ярослав Демкин', 15),
    ('06.06.2025', 'ТОП Севастопольская', 'Сергей', 4),
    ('06.06.2025', 'ТОП Севастопольская', 'Артём', 4),
    ('06.06.2025', 'ТОП Севастопольская', 'Иван', 5),
    ('06.06.2025', 'ТОП Севастопольская', 'Михаил Г', 13),
    ('06.06.2025', 'Воркаут Царицыно', 'Михаил Г', 11),
    ('06.06.2025', 'Воркаут Царицыно', 'Ярослав Демкин', 11),
    ('07.06.2025', 'ТОП Мытищи', 'Сергей', 27),
    ('07.06.2025', 'ТОП Мытищи', 'Анастасия (1-й день)', 12),
    ('07.06.2025', 'ТОП Мытищи', 'Андрей', 12),
    ('07.06.2025', 'ТОП Беляево', 'Артём', 1),
    ('07.06.2025', 'ТОП Беляево', 'Михаил', 10),
    ('07.06.2025', 'ТОП Беляево', 'Анастасия', 7)
  ) AS t(date_str, org_name, user_name, contacts)
)
INSERT INTO t_p24058207_website_creation_pro.leads_analytics 
  (user_id, organization_id, lead_type, lead_result, is_active, created_at)
SELECT 
  u.id,
  o.id,
  'контакт',
  '',
  true,
  TO_TIMESTAMP(sd.date_str, 'DD.MM.YYYY') - INTERVAL '3 hours'
FROM source_data sd
JOIN t_p24058207_website_creation_pro.users u ON u.name = sd.user_name
JOIN t_p24058207_website_creation_pro.organizations o ON o.name = sd.org_name
CROSS JOIN generate_series(1, sd.contacts);