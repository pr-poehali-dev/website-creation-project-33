-- Загрузка строк 102-151
WITH source_data AS (
  SELECT * FROM (VALUES
    ('08.06.2025', 'ТОП Беляево', 'Михаил', 2),
    ('08.06.2025', 'КиберВан', 'Артём', 8),
    ('08.06.2025', 'КиберВан', 'Сергей', 6),
    ('09.06.2025', 'ТОП Беляево', 'Михаил', 13),
    ('09.06.2025', 'ТОП Беляево', 'Ярослав Демкин', 14),
    ('09.06.2025', 'КиберВан', 'Филипп Олейник', 13),
    ('09.06.2025', 'КиберВан', 'Артём', 2),
    ('10.06.2025', 'ТОП Домодедовская', 'Михаил', 11),
    ('10.06.2025', 'ТОП Домодедовская', 'Сергей', 19),
    ('10.06.2025', 'ТОП Домодедовская', 'Филипп Олейник', 19),
    ('10.06.2025', 'ТОП Шаболовская', 'Иван', 3),
    ('13.06.2025', 'ТОП Академическая', 'Иван Науменко', 9),
    ('13.06.2025', 'ТОП Академическая', 'Николай', 6),
    ('13.06.2025', 'ТОП Академическая', 'Сергей', 1),
    ('13.06.2025', 'ТОП Академическая', 'Илья', 7),
    ('13.06.2025', 'ТОП Академическая', 'Ярослав Демкин', 15),
    ('13.06.2025', 'ТОП Перово Академия', 'Филипп Олейник', 30),
    ('13.06.2025', 'ТОП Перово Академия', 'Иван Марфицын', 21),
    ('14.06.2025', 'ТОП Севастопольская', 'Варвара', 3),
    ('14.06.2025', 'ТОП Севастопольская', 'Иван Марфицын', 14),
    ('14.06.2025', 'ТОП Севастопольская', 'Иван (1-й день)', 12),
    ('14.06.2025', 'ТОП Севастопольская', 'Ренат', 5),
    ('14.06.2025', 'ТОП Севастопольская', 'Евгений', 8),
    ('16.06.2025', 'ТОП Шаболовская', 'Филипп Олейник', 5),
    ('16.06.2025', 'ТОП Шаболовская', 'Иван Кустарев', 3),
    ('16.06.2025', 'ТОП Шаболовская', 'Евгений', 1),
    ('16.06.2025', 'ТОП Шаболовская', 'Иван Науменко', 3),
    ('16.06.2025', 'ТОП Шаболовская', 'Ренат', 6),
    ('16.06.2025', 'ТОП Пушкино Колледж', 'Иван Науменко', 5),
    ('16.06.2025', 'ТОП Пушкино', 'Иван Науменко', 5),
    ('16.06.2025', 'ТОП Пушкино Колледж', 'Сергей', 4),
    ('16.06.2025', 'ТОП Пушкино', 'Сергей', 8),
    ('16.06.2025', 'Воркаут Царицыно', 'Филипп Олейник', 20),
    ('16.06.2025', 'Воркаут Царицыно', 'Иван Кустарев', 12),
    ('18.06.2025', 'ТОП Академическая', 'Амир', 3),
    ('18.06.2025', 'ТОП Академическая', 'Филипп Олейник', 5),
    ('18.06.2025', 'ТОП Академическая', 'Ренат', 1),
    ('18.06.2025', 'ТОП Речной', 'Сергей', 12),
    ('18.06.2025', 'ТОП Речной', 'Ярослав Демкин', 12),
    ('18.06.2025', 'ТОП Речной', 'Иван Науменко', 7),
    ('18.06.2025', 'ТОП Речной', 'Алиса', 5),
    ('18.06.2025', 'ТОП Речной', 'Иван Марфицын', 1),
    ('20.06.2025', 'ТОП Перово Академия', 'Ярослав Демкин', 18),
    ('20.06.2025', 'ТОП Перово Академия', 'Иван Марфицын', 7),
    ('20.06.2025', 'ТОП Перово Академия', 'Иван Мухин', 9),
    ('20.06.2025', 'ТОП Академическая', 'Сергей', 12),
    ('20.06.2025', 'ТОП Академическая', 'Дарья', 14),
    ('20.06.2025', 'ТОП Мытищи', 'Диана Гумерова', 15),
    ('20.06.2025', 'ТОП Мытищи', 'Кирилл', 8),
    ('20.06.2025', 'ТОП Мытищи', 'Андрей', 4)
  ) AS t(date_str, org_name, user_name, contacts)
)
INSERT INTO t_p24058207_website_creation_pro.leads_analytics 
  (user_id, organization_id, lead_type, lead_result, is_active, created_at)
SELECT 
  u.id,
  o.id,
  'контакт',
  '',
  true,
  TO_TIMESTAMP(sd.date_str, 'DD.MM.YYYY') - INTERVAL '3 hours'
FROM source_data sd
JOIN t_p24058207_website_creation_pro.users u ON u.name = sd.user_name
JOIN t_p24058207_website_creation_pro.organizations o ON o.name = sd.org_name
CROSS JOIN generate_series(1, sd.contacts);