-- Загрузка строк 152-200
WITH source_data AS (
  SELECT * FROM (VALUES
    ('20.06.2025', 'ТОП Мытищи', 'Филипп Олейник', 15),
    ('20.06.2025', 'ТОП Мытищи', 'Иван Кустарев', 12),
    ('20.06.2025', 'ТОП Мытищи', 'Анастасия', 1),
    ('20.06.2025', 'ТОП Щелково', 'Мария', 2),
    ('21.06.2025', 'ТОП Беляево', 'Дарья', 18),
    ('21.06.2025', 'ТОП Беляево', 'Иван Марфицын', 9),
    ('21.06.2025', 'ТОП Беляево', 'Диана Гумерова', 20),
    ('21.06.2025', 'ТОП Беляево', 'Вячеслав', 10),
    ('21.06.2025', 'ТОП Беляево', 'Максим', 8),
    ('21.06.2025', 'ТОП Люберцы', 'Филипп Олейник', 20),
    ('21.06.2025', 'ТОП Люберцы', 'Иван Кустарев', 20),
    ('21.06.2025', 'ТОП Шаболовская', 'Алиса К', 19),
    ('21.06.2025', 'ТОП Шаболовская', 'Александр', 1),
    ('22.06.2025', 'СкайПро', 'Дарья', 7),
    ('22.06.2025', 'СкайПро', 'Алиса К', 10),
    ('22.06.2025', 'СкайПро', 'Иван Кустарев', 1),
    ('22.06.2025', 'СкайПро', 'Михаил', 5),
    ('22.06.2025', 'СкайПро', 'Ещё 2 дня работы', 83),
    ('23.06.2025', 'Воркаут Царицыно', 'Ярослав Демкин', 13),
    ('23.06.2025', 'Воркаут Царицыно', 'Ульяна', 7),
    ('24.06.2025', 'ТОП Академическая', 'Михаил', 5),
    ('24.06.2025', 'ТОП Академическая', 'Филипп Олейник', 12),
    ('24.06.2025', 'ТОП Академическая', 'Ульяна', 2),
    ('24.06.2025', 'ТОП Академическая', 'Иван Кустарев', 8),
    ('25.06.2025', 'ТОП Шаболовская', 'Алиса', 18),
    ('25.06.2025', 'ТОП Шаболовская', 'Ярослав Демкин', 12),
    ('25.06.2025', 'ТОП Шаболовская', 'Иван Попов', 3),
    ('25.06.2025', 'ТОП Шаболовская', 'Михаил Г', 11),
    ('25.06.2025', 'ТОП Шаболовская', 'Илья Т', 1),
    ('26.06.2025', 'ТОП Речной', 'Степан', 6),
    ('26.06.2025', 'ТОП Речной', 'Алиса', 6),
    ('26.06.2025', 'ТОП Академическая', 'Михаил Г', 3),
    ('26.06.2025', 'ТОП Академическая', 'Иван Попов', 4),
    ('27.06.2025', 'ТОП Речной', 'Степан', 3),
    ('28.06.2025', 'ТОП Пушкино', 'Степан', 9),
    ('28.06.2025', 'ТОП Пушкино Колледж', 'Степан', 5),
    ('28.06.2025', 'ТОП Пушкино', 'Иван Марфицын', 15),
    ('29.06.2025', 'ТОП Беляево', 'Алиса', 1),
    ('29.06.2025', 'ТОП Перово Академия', 'Ярослав Демкин', 9),
    ('01.07.2025', 'ТОП Академическая', 'Диана Гумерова', 11),
    ('02.07.2025', 'ТОП Академическая', 'Диана Гумерова', 25),
    ('02.07.2025', 'ТОП Академическая', 'Иван Науменко', 5),
    ('02.07.2025', 'ТОП Академическая', 'Мария', 6),
    ('02.07.2025', 'ТОП Академическая', 'Вероника Тарасова', 6),
    ('02.07.2025', 'ТОП Академическая', 'Денис', 2),
    ('03.07.2025', 'ТОП Беляево', 'Диана Гумерова', 39),
    ('03.07.2025', 'ТОП Беляево', 'Ярослав Демкин', 13),
    ('03.07.2025', 'ТОП Беляево', 'Мария 5808', 1),
    ('03.07.2025', 'ТОП Беляево', 'Вероника Тарасова', 3)
  ) AS t(date_str, org_name, user_name, contacts)
)
INSERT INTO t_p24058207_website_creation_pro.leads_analytics 
  (user_id, organization_id, lead_type, lead_result, is_active, created_at)
SELECT 
  u.id,
  o.id,
  'контакт',
  '',
  true,
  TO_TIMESTAMP(sd.date_str, 'DD.MM.YYYY') - INTERVAL '3 hours'
FROM source_data sd
JOIN t_p24058207_website_creation_pro.users u ON u.name = sd.user_name
JOIN t_p24058207_website_creation_pro.organizations o ON o.name = sd.org_name
CROSS JOIN generate_series(1, sd.contacts);